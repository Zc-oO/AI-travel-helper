<!--pages/plan/result/result.wxml-->
<view class="container">
  <!-- å¤´éƒ¨ -->
  <view class="header">
    <view class="back-button" bindtap="goBack">
      <text class="back-icon">â†</text>
    </view>
    <view class="header-title">è¡Œç¨‹è¯¦æƒ…</view>
    <view class="more-button" bindtap="showMore">
      <text class="more-icon">â‹¯</text>
    </view>
  </view>

  <!-- ä¸»è¦å†…å®¹ -->
  <view class="main-content">
    <!-- è¡Œç¨‹å°é¢ -->
    <view class="trip-cover">
      <image class="cover-image" src="{{coverImage || '/images/default-cover.jpg'}}" mode="aspectFill" />
      <view class="cover-overlay">
        <view class="trip-badge">AIç”Ÿæˆçš„è¡Œç¨‹</view>
      </view>
    </view>

    <!-- è¡Œç¨‹æ¦‚è¦ -->
    <view class="trip-summary">
      <view class="trip-title">{{tripTitle}}</view>
      <view class="trip-info">
        <view class="info-row">
          <view class="info-item">
            <text class="info-icon">ğŸ“…</text>
            <text class="info-text">{{travelDate}}</text>
          </view>
          <view class="info-item">
            <text class="info-icon">ğŸ’°</text>
            <text class="info-text">{{budget}}</text>
          </view>
        </view>
        <view class="info-row">
          <view class="info-item">
            <text class="info-icon">ğŸ¨</text>
            <text class="info-text">{{hotelLevel}}</text>
          </view>
          <view class="info-item">
            <text class="info-icon">ğŸ“</text>
            <text class="info-text">{{attractions}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- æ—¥ç¨‹å¯¼èˆª -->
    <view class="schedule-nav">
      <scroll-view class="nav-scroll" scroll-x="true">
        <view class="nav-items">
          <view 
            class="nav-item {{currentDay === index ? 'active' : ''}}"
            wx:for="{{dayList}}"
            wx:key="date"
            bindtap="switchDay"
            data-day="{{index}}"
          >
            <view class="nav-date">{{item.date}}</view>
            <view class="nav-day">{{item.day}}</view>
          </view>
        </view>
      </scroll-view>
    </view>

    <!-- å½“æ—¥è¡Œç¨‹ -->
    <view class="daily-schedule" wx:if="{{currentDayData}}">
      <view class="day-title">{{currentDayData.title}}</view>
      <view class="day-time">{{currentDayData.time}}</view>
      
      <!-- æ´»åŠ¨åˆ—è¡¨ -->
      <view class="activities-list">
        <view 
          class="activity-item"
          wx:for="{{currentDayData.activities}}"
          wx:key="id"
        >
          <view class="activity-time">{{item.time}}</view>
          <view class="activity-content">
            <view class="activity-name">{{item.name}}</view>
            <view class="activity-desc">{{item.description}}</view>
            <view class="activity-location" wx:if="{{item.location}}">
              <text class="location-icon">ğŸ“</text>
              <text class="location-text">{{item.location}}</text>
            </view>
          </view>
        </view>
      </view>

      <!-- æ¨èå¡ç‰‡ -->
      <view class="recommendation-card" wx:if="{{currentDayData.recommendation}}">
        <view class="rec-title">æ¨è</view>
        <view class="rec-content">
          <image class="rec-image" src="{{currentDayData.recommendation.image}}" mode="aspectFill" />
          <view class="rec-info">
            <view class="rec-name">{{currentDayData.recommendation.name}}</view>
            <view class="rec-desc">{{currentDayData.recommendation.description}}</view>
          </view>
          <view class="love-icon" bindtap="toggleLove" data-id="{{currentDayData.recommendation.id}}">
            <text class="love-text">{{currentDayData.recommendation.loved ? 'â¤ï¸' : 'ğŸ¤'}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- é€‰æ‹©æœ¬è®¡åˆ’æŒ‰é’® -->
    <view class="action-section">
      <button class="btn-primary" bindtap="selectPlan">
        é€‰æ‹©æœ¬è®¡åˆ’
      </button>
    </view>

    <!-- ä½å®¿ä¿¡æ¯ -->
    <view class="accommodation-section" wx:if="{{hotels.length > 0}}">
      <view class="section-title">æ¨èä½å®¿</view>
      <view 
        class="hotel-card"
        wx:for="{{hotels}}"
        wx:key="id"
        bindtap="viewHotel"
        data-hotel="{{item}}"
      >
        <image class="hotel-image" src="{{item.image || '/images/default-hotel.jpg'}}" mode="aspectFill" />
        <view class="hotel-info">
          <view class="hotel-name">{{item.name}}</view>
          <view class="hotel-location">{{item.location}}</view>
          <view class="hotel-price">{{item.price}}</view>
          <view class="hotel-rating">
            <text class="rating-text">{{item.rating}}</text>
            <text class="rating-stars">â­</text>
          </view>
        </view>
      </view>
    </view>

    <!-- é”™è¯¯çŠ¶æ€ -->
    <view class="error-container" wx:if="{{errorMessage}}">
      <text class="error-text">{{errorMessage}}</text>
      <button class="retry-button" bindtap="retryLoad">é‡æ–°åŠ è½½</button>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-container" wx:if="{{isLoading}}">
      <view class="loading-icon">â³</view>
      <view class="loading-text">åŠ è½½è¡Œç¨‹è¯¦æƒ…ä¸­...</view>
    </view>
  </view>
</view>